C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 1   


C51 COMPILER V8.02, COMPILATION OF MODULE ST7920LCD
OBJECT MODULE PLACED IN ST7920LCD.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE ST7920LCD.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <reg51.h> 
   2          #include <intrins.h> 
   3          /*定义管脚*/ 
   4          sbit RS = P2^3; 
   5          sbit RW = P2^4; 
   6          sbit E = P2^5; 
   7          sbit PSB = P2^6;
   8          #define Lcd_Bus P0        //MCU P2<------> LCM 
   9          #define FIRST_ADDR 0       //定义字符/汉字显示起始位置 
  10          
  11          unsigned char code zk[]={ 
  12          0x08,0x20,0x1c,0x10,0x1c,0x1c,0xff,0x9e,0x7f,0x1e,0x1c,0x1f,0x3e,0x1f,0x3e,0x1f, 
  13          0x77,0x1f,0x41,0x3f,0x00,0x7e,0x00,0xfe,0x83,0xfc,0x7f,0xf8,0x3f,0xf0,0x0f,0xc0, 
  14          }; 
  15          
  16          unsigned char code BMP1[]={ 
  17          /*--  一幅图像 KISS- 正向取模，字节正序*/ 
  18          /*--  宽度x高度=128x64  --*/ 
  19          
  20          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  21          0xFF,0xFF,0xFF,0x9F,0x00,0x00,0x0F,0x0E,0x00,0x00,0x00,0x00,0x19,0xFF,0xFF,0xFF, 
  22          0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xBF,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  23          0x00,0x00,0x00,0x00,0x00,0x00,0x1F,0xFD,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  24          0xFF,0xFF,0xF3,0xE0,0x00,0x00,0x1F,0xFD,0x80,0x00,0x00,0x00,0x00,0x3F,0xFF,0xFF, 
  25          0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0xFA,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00, 
  26          0x00,0x00,0x00,0x00,0x00,0x00,0x07,0xF4,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  27          0xFF,0xFF,0xF0,0x00,0x00,0x00,0x03,0xF8,0x01,0xFF,0xFF,0xE0,0x00,0x07,0xFF,0xFF, 
  28          0x00,0x00,0x00,0x0F,0xFF,0xFC,0x00,0xF0,0x3F,0xFF,0xFF,0xFE,0x00,0x30,0x00,0x00, 
  29          0x00,0x00,0x00,0x7F,0xFF,0xFF,0x80,0x41,0xFF,0xFF,0xFF,0xFF,0xC0,0x00,0x00,0x00, 
  30          0xFF,0xFF,0x01,0xFF,0xFF,0xFF,0xF0,0x02,0x7F,0xFF,0xFF,0xFF,0xE0,0x03,0xFF,0xFF, 
  31          0x00,0x00,0x03,0xFF,0xFF,0xFF,0xF8,0x04,0x3F,0xFF,0xFF,0xFF,0xF0,0x00,0x00,0x00, 
  32          0x00,0x00,0x1F,0xFF,0xFF,0xFF,0xFC,0x08,0x73,0xFF,0xFF,0xFF,0xF8,0x00,0x00,0x00, 
  33          0xFF,0xE4,0x3F,0x7F,0xFF,0xFF,0xFF,0x30,0x2F,0xFF,0xFF,0xFF,0xFE,0x00,0x7F,0xFF, 
  34          0x00,0x00,0xFE,0x9F,0xFF,0xFF,0xFF,0xB0,0x1D,0xFF,0xFF,0xFF,0x3F,0x00,0x00,0x00, 
  35          0x00,0x00,0xFF,0x7F,0xFF,0xFF,0xFF,0xC2,0x23,0x3F,0xFF,0xFE,0x1F,0x80,0x00,0x00,
  36          /*****************************************************************************/ 
  37          0xFF,0xE1,0xFF,0xFF,0xFF,0xFF,0xFC,0xC5,0x92,0xFF,0xB7,0xB8,0xC9,0x80,0x7F,0xFF, 
  38          0x00,0x03,0xFF,0xFF,0xFF,0xFF,0xFC,0x4F,0xEF,0x3F,0xC8,0x1A,0x20,0xC0,0x00,0x00, 
  39          0x00,0x03,0xFF,0xFF,0xFF,0xFF,0xF8,0x7F,0xFF,0xFF,0x75,0x86,0xF6,0xC0,0x00,0x00, 
  40          0xFF,0x03,0xEF,0x9F,0xFB,0xFF,0xF8,0x7F,0xFF,0xFF,0xFB,0xDF,0xFE,0xC0,0x7F,0xFF, 
  41          0x00,0x07,0xDE,0x7F,0xC7,0xFF,0xF0,0x7E,0x7F,0xFF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  42          0x00,0x07,0x1C,0xF7,0x9F,0xDF,0xF0,0x7E,0x7F,0xFF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  43          0xFC,0x07,0x00,0x8C,0x1F,0xBF,0xE7,0x3C,0x3F,0xFF,0xFF,0xFF,0xFF,0xC0,0x7F,0xFF, 
  44          0x00,0x07,0x00,0x08,0x1C,0x3F,0x88,0x3C,0x7F,0xFF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  45          0x00,0x06,0x0C,0x08,0x98,0x7F,0x80,0x0D,0x9F,0xFF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  46          0xFC,0x06,0x1C,0xE3,0x99,0xFF,0x00,0x0C,0x0F,0xFF,0xFF,0xFF,0xFF,0xC0,0x5F,0xFF, 
  47          0x00,0x06,0xF1,0xE3,0x83,0xFE,0x00,0x08,0x03,0xDF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  48          0x00,0x06,0xF1,0xF7,0xC7,0xFE,0x00,0x08,0x01,0xCF,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  49          0xFC,0x06,0xF3,0xF7,0xC7,0xFC,0x03,0x08,0x00,0x01,0xFF,0xFF,0xFF,0xC0,0xBF,0xFF, 
  50          0x00,0x07,0xF3,0xFF,0xE7,0xF0,0x03,0x09,0x80,0x00,0xFF,0xFF,0xFF,0xC0,0x00,0x00, 
  51          0x00,0x07,0xFF,0xFF,0xFF,0xE0,0x03,0x09,0x80,0x00,0x3F,0xFF,0xFF,0x80,0x00,0x00, 
  52          0xFC,0x07,0xFF,0xFF,0xFF,0xC0,0x03,0x09,0x80,0x00,0x0F,0xFF,0xFF,0x83,0xFF,0xFF,
  53          /*****************************************************************************/ 
  54          0x00,0x07,0xFF,0xE0,0xFE,0x00,0x03,0x09,0x80,0x00,0x07,0xFF,0xFF,0x80,0x00,0x00, 
  55          0x00,0x07,0xFF,0x80,0x7C,0x00,0x07,0xB1,0x80,0x00,0x07,0x83,0xFF,0x00,0x00,0x00, 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 2   

  56          0xFF,0x07,0xFF,0x0C,0x00,0x00,0x7F,0xB3,0xC0,0x00,0x06,0x01,0xFE,0x03,0xFF,0xFF, 
  57          0x00,0x07,0xFF,0x03,0x00,0x00,0x1F,0x43,0xFC,0x00,0x06,0x38,0xFE,0x00,0x00,0x00, 
  58          0x00,0x07,0xFF,0x03,0x00,0x00,0x00,0x81,0xF0,0x00,0x04,0x40,0xF8,0x00,0x00,0x00, 
  59          0xFC,0x87,0xFF,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x04,0x40,0xF0,0x07,0xFF,0xFF, 
  60          0x00,0x07,0xFF,0x80,0x00,0x2C,0x00,0x80,0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00, 
  61          0x00,0x07,0xFF,0x80,0x00,0x52,0x00,0x40,0x00,0x00,0x00,0x01,0xE0,0x00,0x00,0x00, 
  62          0xFF,0x83,0xFF,0xF0,0x80,0x2C,0x00,0x40,0x00,0x00,0x00,0x01,0xC0,0x7F,0xFF,0xFF, 
  63          0x00,0x03,0xFF,0xFF,0x80,0x00,0x00,0x30,0x00,0x00,0x01,0x86,0x00,0x00,0x00,0x00, 
  64          0x00,0x03,0xFF,0xFF,0x80,0x00,0x00,0x38,0x00,0x00,0x01,0xF8,0x00,0x00,0x00,0x00, 
  65          0xFF,0xA3,0xFF,0xFF,0x80,0x00,0x00,0x44,0x00,0x00,0x01,0xFF,0x00,0x7F,0xFF,0xFF, 
  66          0x00,0x03,0xFF,0xFF,0x80,0x00,0x03,0x82,0x00,0x00,0x01,0xC0,0xC0,0x00,0x00,0x00, 
  67          0x00,0x03,0xFF,0xFF,0x80,0x00,0x1C,0x01,0xC0,0x00,0x00,0x78,0xC0,0x00,0x00,0x00, 
  68          0xFF,0x81,0xFF,0xFF,0xC0,0x3F,0xE0,0x00,0x3C,0x00,0x07,0x80,0x20,0x7F,0xFF,0xFF, 
  69          0x00,0x01,0xFF,0xFF,0xE0,0x40,0x00,0x00,0x03,0xFE,0x78,0x00,0x20,0x00,0x00,0x00,
  70          /*****************************************************************************/
  71          0x00,0x01,0xFF,0xFF,0xF8,0x40,0x00,0x00,0x00,0x21,0x80,0x00,0x10,0x00,0x00,0x00, 
  72          0xFF,0xC1,0xFF,0xFF,0xFC,0x40,0x00,0x00,0x00,0x2E,0x00,0x00,0x10,0x4F,0xFF,0xFF, 
  73          0x00,0x01,0xFF,0xFF,0xFE,0x20,0x00,0x00,0x00,0x30,0x00,0x00,0x30,0x00,0x00,0x00, 
  74          0x00,0x00,0xFF,0xFF,0xFF,0xA0,0x00,0x00,0x00,0xC0,0x00,0x01,0xF8,0x00,0x00,0x00, 
  75          0xFF,0xE0,0xFF,0xFF,0xFB,0xE0,0x00,0x00,0x00,0xC0,0x00,0x03,0xFE,0x07,0xFF,0xFF, 
  76          0x00,0x00,0xFF,0xFF,0xFD,0xE0,0x00,0x00,0x00,0xC0,0x00,0x1F,0xFF,0x00,0x00,0x00, 
  77          0x00,0x00,0xFF,0xFF,0xFE,0x70,0x00,0x00,0x01,0xE0,0x00,0x3F,0xFF,0x80,0x00,0x00, 
  78          0xFF,0xC0,0xFF,0xFF,0xFF,0xB0,0x00,0x00,0x01,0xE0,0x00,0x7F,0xFF,0xC0,0x3F,0xFF, 
  79          0x00,0x00,0xFF,0xFF,0xFF,0xDC,0x00,0x00,0x03,0xF7,0x81,0xFF,0xFF,0xF0,0x00,0x00, 
  80          0x00,0x01,0xFF,0x80,0x7F,0xDC,0x00,0x00,0x0F,0xFF,0xC3,0xFF,0xFF,0xF8,0x00,0x00, 
  81          0xFF,0x01,0xFF,0x00,0x1F,0xEE,0x00,0x00,0x13,0xFF,0xF7,0xFF,0xFF,0xFC,0x07,0xFF, 
  82          0x00,0x01,0xFE,0x00,0x07,0xEF,0x00,0x00,0x1F,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00, 
  83          0x00,0x01,0xFC,0x00,0x03,0xF3,0x00,0x00,0x13,0xFF,0xBF,0xFF,0xFF,0xFF,0x80,0x00, 
  84          0xFF,0x01,0xFC,0x00,0x01,0xF3,0x80,0x00,0x1F,0xFF,0xBF,0xFF,0xFF,0xFF,0x83,0xFF, 
  85          0x00,0x01,0xF0,0x00,0x01,0xFD,0x80,0x00,0x0F,0xFF,0x7F,0xFF,0xFF,0xFF,0xC0,0x00, 
  86          0x00,0x03,0xF0,0x00,0x00,0x72,0xE0,0x00,0x03,0xFE,0xFF,0xFF,0xFF,0xFF,0xC0,0x00 
  87          
  88          };   
  89          
  90          unsigned char code BMP[]={ 
  91          //一幅图像 - 正向取模，字节正序 
  92          /*--  宽度x高度=128x64  --*/ 
  93          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  94          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  95          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
  96          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00, 
  97          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x20,0x00,0x00,0x00,0x00, 
  98          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x40,0x08,0x00,0x00,0x00, 
  99          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x40,0x08,0x00,0x00,0x00, 
 100          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x40,0x38,0x00,0x00,0x00, 
 101          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,0x60,0x00,0x06,0x00, 
 102          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x01,0x80,0x00,0x38,0x00, 
 103          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x03,0xC0,0x00,0x03,0xC0,0x00, 
 104          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x1C,0x38,0x00,0x1C,0x00,0x00, 
 105          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x04,0x00,0xE0,0x00,0x00, 
 106          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x02,0x03,0x00,0x00,0x00, 
 107          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0E,0x00,0x00,0x80,0x01,0x00,0x00,0x00,0x00, 
 108          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xF0,0x01,0x00,0x00,0x80,0x00,0x00,0x00,
 109          /*****************************************************************************/ 
 110          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x01,0x00,0x00,0x80,0x00,0x00,0x00, 
 111          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE1,0x00,0x00,0x80,0x00,0x00,0x00, 
 112          0x00,0x00,0x0F,0x80,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x40,0x00,0x00,0x00, 
 113          0x00,0x00,0x18,0xC0,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x40,0x00,0x00,0x00, 
 114          0x00,0x00,0x10,0x40,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x41,0xC0,0x00,0x00, 
 115          0x00,0x00,0x30,0x60,0x3F,0xC0,0x00,0x00,0x00,0x02,0x00,0x00,0x40,0x3E,0x00,0x00, 
 116          0x00,0x00,0x20,0x23,0xC0,0x60,0x00,0x00,0x00,0x61,0x00,0x00,0x80,0x01,0xC0,0x00, 
 117          0x00,0x00,0x40,0x3C,0x00,0x18,0x00,0xC0,0x07,0xC1,0x00,0x00,0x80,0x00,0x00,0x00, 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 3   

 118          0x00,0x00,0x40,0x18,0x00,0x04,0x01,0xA0,0x1C,0x01,0x00,0x00,0x80,0x00,0x00,0x00, 
 119          0x00,0x00,0x40,0x08,0x00,0x06,0x02,0x1C,0x00,0x00,0x80,0x01,0x00,0x00,0x00,0x00, 
 120          0x00,0x00,0xC0,0x08,0x00,0x01,0x8C,0x03,0x80,0x00,0x40,0x02,0x00,0x00,0x00,0x00, 
 121          0x00,0x00,0x80,0x0C,0x00,0x00,0x58,0x00,0x60,0x06,0x20,0x04,0x20,0x00,0x00,0x00, 
 122          0x00,0x01,0x00,0x04,0x00,0x00,0x20,0x00,0x10,0x1C,0x1C,0x38,0x18,0x00,0x00,0x00, 
 123          0x00,0x01,0x00,0x06,0x00,0x00,0x30,0x00,0x08,0x30,0x03,0xC0,0x07,0x00,0x00,0x00, 
 124          0x00,0x01,0x00,0x02,0x00,0x00,0x18,0x00,0x04,0x60,0x00,0x00,0x01,0x80,0x00,0x00, 
 125          0x00,0x02,0x00,0x00,0x00,0x00,0x0C,0x00,0x03,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
 126          /*****************************************************************************/
 127          0x00,0x02,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x80,0x02,0x08,0x00,0x30,0x00,0x00, 
 128          0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x02,0x08,0x00,0x18,0x00,0x00, 
 129          0x00,0x0C,0x00,0x00,0x7F,0xFC,0x00,0x00,0x00,0x20,0x02,0x04,0x00,0x00,0x00,0x00, 
 130          0x00,0x0C,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x18,0x02,0x04,0x00,0x00,0x00,0x00, 
 131          0x00,0x18,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x07,0xF2,0x02,0x00,0x00,0x00,0x00, 
 132          0x00,0x30,0x00,0x00,0x0F,0xFC,0x00,0x00,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00, 
 133          0x00,0x60,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00, 
 134          0x00,0x40,0x00,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00, 
 135          0x01,0x80,0x00,0x00,0x0F,0xFF,0xFF,0xFF,0xFF,0xE0,0x00,0x00,0x80,0x00,0x00,0x00, 
 136          0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
 137          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
 138          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
 139          0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
 140          0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x1C,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00, 
 141          0x00,0x00,0x00,0x00,0x00,0x00,0x19,0x8C,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00, 
 142          0x00,0x00,0x00,0x00,0x00,0x00,0x30,0xCC,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0x00,
 143          
 144          /*
 145           "太",     "阳",    "出",      "来",    "喜",     "洋",     "洋",     "喽",*/
 146           0x01,0x00,0x00,0x00,0x01,0x00,0x01,0x00,0x01,0x00,0x22,0x10,0x22,0x10,0x00,0x48,
 147           0x01,0x00,0x7D,0xFC,0x01,0x00,0x01,0x00,0x7F,0xFC,0x11,0x10,0x11,0x10,0x02,0x4C,
 148           0x01,0x00,0x45,0x04,0x21,0x04,0x3F,0xFC,0x01,0x00,0x11,0x20,0x11,0x20,0xF1,0x50,
 149           0x01,0x00,0x49,0x04,0x21,0x04,0x01,0x00,0x3F,0xF8,0x07,0xFC,0x07,0xFC,0x97,0xFE,
 150           0x7F,0xFE,0x49,0x04,0x21,0x04,0x09,0x30,0x00,0x00,0x80,0x40,0x80,0x40,0x90,0xE0,
 151           0x01,0x00,0x51,0x04,0x21,0x04,0x05,0x20,0x1F,0xF0,0x50,0x40,0x50,0x40,0x91,0x50,
 152           0x01,0x00,0x49,0xFC,0x3F,0xFC,0x03,0x40,0x10,0x10,0x57,0xFC,0x57,0xFC,0x92,0x4E,
 153           0x01,0x00,0x45,0x04,0x21,0x04,0x7F,0xFE,0x1F,0xF0,0x10,0x40,0x10,0x40,0x9D,0x44,
 154           0x02,0x80,0x45,0x04,0x01,0x00,0x01,0x80,0x04,0x40,0x20,0x40,0x20,0x40,0x91,0x00,
 155           0x02,0x40,0x45,0x04,0x21,0x04,0x03,0x40,0xFF,0xFE,0x2F,0xFE,0x2F,0xFE,0xF7,0xFC,
 156           0x04,0x20,0x69,0x04,0x21,0x04,0x05,0x20,0x00,0x00,0xE0,0x40,0xE0,0x40,0x92,0x10,
 157           0x05,0x10,0x51,0x04,0x21,0x04,0x09,0x18,0x1F,0xF0,0x20,0x40,0x20,0x40,0x83,0x20,
 158           0x08,0x98,0x41,0xFC,0x21,0x04,0x31,0x0E,0x10,0x10,0x20,0x40,0x20,0x40,0x00,0xE0,
 159           0x10,0xCC,0x41,0x04,0x3F,0xFC,0xC1,0x04,0x10,0x10,0x20,0x40,0x20,0x40,0x01,0x18,
 160           0x20,0x86,0x40,0x00,0x01,0x00,0x01,0x00,0x1F,0xF0,0x20,0x40,0x20,0x40,0x02,0x0C,
 161           0x40,0x04,0x40,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x20,0x40,0x20,0x40,0x04,0x08
 162            }; 
 163          
 164          /*------------------检查忙位-----------------------------*/ 
 165          void chk_busy() 
 166          {  RS=0; 
 167   1         RW=1; 
 168   1         E=1; 
 169   1         Lcd_Bus=0xff; 
 170   1         while((Lcd_Bus&0x01)==0x01); 
 171   1         E=0; 
 172   1      } 
 173          /*------------------延时子程序-----------------------------*/ 
 174          void delay(unsigned int t) 
 175          {  unsigned int i,j; 
 176   1         for(i=0;i<t;i++) 
 177   1            for(j=0;j<10;j++); 
 178   1      } 
 179          /*------------------写命令到LCD------------------------------*/ 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 4   

 180          void write_com(unsigned char cmdcode) 
 181          { 
 182   1      chk_busy(); 
 183   1      RS=0; 
 184   1      RW=0; 
 185   1      E=1; 
 186   1      cmdcode = ((cmdcode&0x01)<<7)|((cmdcode&0x02)<<5)|((cmdcode&0x04)<<3)|((cmdcode&0x08)<<1)|((cmdcode&0x10)>
             ->1)|((cmdcode&0x20)>>3)|((cmdcode&0x40)>>5)|((cmdcode&0x80)>>7);
 187   1      Lcd_Bus=cmdcode; 
 188   1      delay(5);////////////////////在数据写入的时候加入适当的延时 
 189   1      E=0; 
 190   1      delay(5); 
 191   1      } 
 192          /*-------------------写数据到LCD----------------------------*/ 
 193          void write_data(unsigned char Dispdata) 
 194          { 
 195   1      chk_busy(); 
 196   1      RS=1; 
 197   1      RW=0; 
 198   1      E=1; 
 199   1      Dispdata = ((Dispdata&0x01)<<7)|((Dispdata&0x02)<<5)|((Dispdata&0x04)<<3)|((Dispdata&0x08)<<1)|((Dispdata&
             -0x10)>>1)|((Dispdata&0x20)>>3)|((Dispdata&0x40)>>5)|((Dispdata&0x80)>>7);
 200   1      Lcd_Bus=Dispdata; 
 201   1      delay(5);///////////////////在数据写入的时候加入适当的延时 
 202   1      E=0; 
 203   1      delay(5); 
 204   1      } 
 205          /*------------------初始化LCD屏--------------------------*/ 
 206          void lcdreset() 
 207          {  delay(2000); 
 208   1         write_com(0x30); 
 209   1         delay(10);             //选择基本指令集 
 210   1         write_com(0x30);       //选择8bit数据流 
 211   1         delay(5); 
 212   1         write_com(0x0c);       //开显示(无游标、不反白) 
 213   1         delay(10); 
 214   1         write_com(0x01);       //清除显示，并且设定地址指针为00H 
 215   1         delay(500); 
 216   1         write_com(0x06);       //指定在资料的读取及写入时，设定游标的移动方向及指定显示的移位 
 217   1         delay(0); 
 218   1      } 
 219          /*------------------自定义一个字符代码(一个星星和月亮)--------------------------*/ 
 220          void CGRAM() 
 221          { int i; 
 222   1           write_com(0x30);   
 223   1           write_com(0x40); 
 224   1           for(i=0;i<16;i++) 
 225   1           {write_data(zk[i*2]); 
 226   2            write_data(zk[i*2+1]); 
 227   2            } 
 228   1      }       
 229          /*------------------显示字符串--------------------------*/ 
 230          void hzkdis(unsigned char code *s) 
 231          {  while(*s>0) 
 232   1         {  write_data(*s); 
 233   2            s++; 
 234   2            delay(50); 
 235   2         } 
 236   1      } 
 237          /*------------------首屏显示--------------------------*/ 
 238          void ceshi() 
 239          {write_com(0x01);//清除显示，并且设定地址指针为00H 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 5   

 240   1      delay(5); 
 241   1      
 242   1      write_com(0x80);//第一行（如果是地址是：80H，即LCD的第一行的第一个位置显示） 
 243   1      hzkdis("欢迎使用"); 
 244   1      
 245   1      write_com(0x90);//第二行（如果是地址是：90H，即LCD的第二行的第一个位置显示） 
 246   1      hzkdis("厦门智控开发板"); 
 247   1      
 248   1      write_com(0x88);//第三行（如果是地址是：88H，即LCD的第二行的第一个位置显示） 
 249   1      hzkdis("TEL15980845601"); 
 250   1      
 251   1      write_com(0x98);//第四行（如果是地址是：98H，即LCD的第二行的第一个位置显示） 
 252   1      hzkdis("测试程序"); 
 253   1      
 254   1      
 255   1      } 
 256          /*------------------显示图片------------------------*/ 
 257          void Disp_Img(unsigned char code *img) 
 258          {  unsigned int j=0; 
 259   1         unsigned char x,y,i; 
 260   1             for(i=0;i<9;i+=8) 
 261   1             for(y=0;y<32;y++)/*原来 为 y<26 ,上下两个半屏不能正常对接显示，导致显示的图片中间有空隙*/ 
 262   1               for(x=0;x<8;x++) 
 263   1               {  write_com(0x36);//功能设置---8BIT控制界面，扩充指令集 
 264   2                  write_com(y+0x80);        //行地址 
 265   2                  write_com(x+0x80+i);     //列地址 
 266   2                  write_com(0x30); 
 267   2                  write_data(img[j++]); 
 268   2                  write_data(img[j++]); 
 269   2               }   
 270   1                 
 271   1      } 
 272          /*------------------清整个GDRAM空间----------------------------*/ 
 273          void clrgdram() 
 274          { unsigned char x,y; 
 275   1              for(y=0;y<64;y++) 
 276   1               for(x=0;x<16;x++) 
 277   1               {  write_com(0x34); 
 278   2                  write_com(y+0x80);        //行地址 
 279   2                  write_com(x+0x80);     //列地址 
 280   2                  write_com(0x30); 
 281   2                  write_data(0x00); 
 282   2                  write_data(0x00); 
 283   2                                     } 
 284   1         } 
 285          /*------------------整屏写入数据:全亮，或者竖条-----------------------------*/ 
 286          void lcdfill(unsigned char disdata) 
 287          { unsigned char x,y; 
 288   1              for(y=0;y<32;y++) 
 289   1               for(x=0;x<16;x++) 
 290   1               {  write_com(0x36); 
 291   2                  write_com(y+0x80);        //行地址 
 292   2                  write_com(x+0x80);     //列地址 
 293   2                  write_com(0x30); 
 294   2                  write_data(disdata); 
 295   2                  write_data(disdata); 
 296   2                  } 
 297   1         write_com(0x34);                             
 298   1         write_com(0x36); 
 299   1         } 
 300          /*------------------显示横-----------------------------*/ 
 301          void Disp_H_Line() 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 6   

 302          {  unsigned char x,y; 
 303   1         unsigned char k=0x00;   
 304   1             for(y=0;y<32;y++) 
 305   1               { k=~k; 
 306   2                 for(x=0;x<16;x++) 
 307   2               {  write_com(0x36); 
 308   3                  write_com(y+0x80);      //行地址 
 309   3                  write_com(x+0x80);     //列地址 
 310   3                  write_com(0x30); 
 311   3                  write_data(k); 
 312   3                  write_data(k); 
 313   3                 }; 
 314   2               } 
 315   1           write_com(0x34);                           
 316   1         write_com(0x36); 
 317   1      } 
 318          /*------------------显示边框-------------------------------*/ 
 319          void Frame() 
 320          {unsigned char x,y; 
 321   1                lcdfill(0x00); 
 322   1              for(x=0;x<9;x+=8) 
 323   1                for(y=0;y<32;y++) 
 324   1                 { write_com(0x36); 
 325   2                  write_com(y+0x80);      //行地址 
 326   2                  write_com(x+0x80);        //列地址 
 327   2                  write_com(0x30); 
 328   2                  write_data(0x80); 
 329   2                  write_data(0x00); 
 330   2                 
 331   2                  write_com(0x36); 
 332   2                  write_com(y+0x80);      //行地址 
 333   2                  write_com(x+0x87);        //列地址 
 334   2                  write_com(0x30); 
 335   2                  write_data(0x00); 
 336   2                  write_data(0x01); 
 337   2                   
 338   2                  } 
 339   1            for(y=0;y<2;y++) 
 340   1               for(x=0;x<8;x++) 
 341   1                 {write_com(0x36); 
 342   2                  write_com(y*31+0x80);      //行地址 
 343   2                  write_com(x+0x80+8*y);        //列地址 
 344   2                  write_com(0x30); 
 345   2                  write_data(0xff); 
 346   2                  write_data(0xff); 
 347   2                 } 
 348   1               write_com(0x34); 
 349   1               write_com(0x36); 
 350   1                          } 
 351          
 352          /*------------------在第7列的位置加入两条竖线--------------------------*/ 
 353          void shuxian() 
 354          { unsigned char x,y; 
 355   1           
 356   1          for(x=0;x<9;x+=8) 
 357   1             for(y=0;y<32;y++) 
 358   1                { write_com(0x36); 
 359   2                  write_com(y+0x80);    //行地址 
 360   2                  write_com(x+0x86);     //列地址 
 361   2                  write_com(0x30); 
 362   2                  write_data(0x00); 
 363   2                  write_data(0x14); 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 7   

 364   2                }; 
 365   1      }     
 366                     
 367          /*------------------清屏命令--------------------------*/   
 368          void clrscreen() 
 369          { 
 370   1         write_com(0x01); 
 371   1         delay(10); 
 372   1         } 
 373             
 374          /*------------------唐诗《静夜思》--------------------------*/ 
 375          void gushi_display() 
 376          {  write_com(0x30); 
 377   1         clrscreen();   
 378   1         write_com(0x80+FIRST_ADDR); 
 379   1         hzkdis("白日依山尽，"); 
 380   1         write_com(0x90+FIRST_ADDR); 
 381   1         hzkdis("黄河入海流。"); 
 382   1         write_com(0x88+FIRST_ADDR); 
 383   1         hzkdis("欲穷千里目，"); 
 384   1         write_com(0x98+FIRST_ADDR); 
 385   1         hzkdis("更上一层楼。"); 
 386   1         write_com(0xb3+FIRST_ADDR); 
 387   1         hzkdis("登鹳雀楼"); 
 388   1         write_com(0xaa+FIRST_ADDR); 
 389   1         hzkdis("( 唐 )王之焕"); 
 390   1      } 
 391          
 392          main() 
 393          {  unsigned char i; 
 394   1      //      du=0;
 395   1      //      we=0;
 396   1         while(1) 
 397   1         { 
 398   2          PSB=0;
 399   2       delay(300);
 400   2       PSB=1;        
 401   2           RW=0; 
 402   2            lcdreset();                    //初始化LCD屏 
 403   2            CGRAM();                         
 404   2            ceshi();                      //显示测试字样 
 405   2           delay(2000); 
 406   2           
 407   2            clrgdram(); 
 408   2           clrscreen();                  //清屏 
 409   2           Disp_Img(BMP);               //调入一幅图画 
 410   2            delay(30000); 
 411   2      
 412   2           Disp_Img(BMP1);               //调入一幅图画 
 413   2            delay(20000); 
 414   2                         
 415   2           lcdfill(0xff);               //显示全开 
 416   2            delay(2000);             
 417   2           
 418   2           Disp_H_Line();                //显示横条 
 419   2             delay(2000); 
 420   2      
 421   2             lcdfill(0xaa);               //显示竖条 
 422   2            delay(2000); 
 423   2           
 424   2            Frame();                     //显示边框 
 425   2            delay(2000); 
C51 COMPILER V8.02   ST7920LCD                                                             05/22/2011 10:21:44 PAGE 8   

 426   2             
 427   2           gushi_display();             //显示唐诗 
 428   2            clrgdram(); 
 429   2                 
 430   2           write_com(0x87);          //调用自定义的CGRAM的代码 
 431   2           write_data(0x00); 
 432   2           write_data(0x00); 
 433   2           delay(400); 
 434   2             
 435   2            shuxian();              //加入两条竖线 
 436   2            delay(8000); 
 437   2            write_com(0x30); 
 438   2             delay(2000); 
 439   2                   
 440   2            gushi_display(); 
 441   2            delay(6000); 
 442   2            for(i=0;i<8;i++)        //字符循环左移 
 443   2           {write_com(0x18);   
 444   3              delay(2000);} 
 445   2                 
 446   2             gushi_display(); 
 447   2            delay(6000);   
 448   2           write_com(0x36);         
 449   2            write_com(0x04);          //第一行反白显示 
 450   2            delay(6000); 
 451   2            write_com(0x04);          //第一行恢复正常 
 452   2            delay(6000); 
 453   2             write_com(0x05);          //第二行反白显示 
 454   2            delay(6000); 
 455   2            write_com(0x05);          //第二行恢复正常 
 456   2            delay(6000); 
 457   2                 
 458   2            write_com(0x03);         //垂直滚动屏幕的内容 
 459   2            write_com(0x60); 
 460   2            delay(6000); 
 461   2         } 
 462   1      } 
 463           
 464           


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1206    ----
   CONSTANT SIZE    =   2202    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      17
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
